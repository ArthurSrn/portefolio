---
import { storyblokEditable } from "@storyblok/astro";
import type { SbBlokData } from "@storyblok/js";
import type {
  Navbar,
  NavigationItems,
} from "../../.storyblok/types/285539525668951/storyblok-components";
import { Image } from "astro:assets";

interface Props {
  blok: Navbar;
}

const { blok }: Props = Astro.props;
---

<!-- <style>
  * {
    border: 1px solid red;
  }
</style> -->

<script>
  console.log("gsap version", window.gsap.version);
  
  // Sélectionner TOUS les éléments avec la classe "test"
  const testElements = document.querySelectorAll(".test");
  
  // Appliquer les event listeners à chaque élément
  testElements.forEach((element) => {
    element.addEventListener("mouseenter", () => 
      gsap.to(element, { color: "#007BFF", duration: 0.3 })
    );
    element.addEventListener("mouseleave", () => 
      gsap.to(element, { color: "#000", duration: 0.3 })
    );
  });
</script>

<nav {...storyblokEditable(blok as SbBlokData)} class="flex justify-center gap-4 sticky">
  <div class="flex items-center gap-6 p-2 bg-emerald-500 rounded-full mt-2">
    <a href="/">
      <Image
        src={blok.Logo?.filename || ""}
        alt={blok.Logo?.alt || "Site logo"}
        width={50}
        height={50}
        class="border-2 border-red-500 rounded-full"
        loading="lazy"
      />
    </a>

    <ul class="flex gap-6">
      {
        blok.navigation_items?.map((item) => {
          const navItem = item as NavigationItems;
          return <li class="test" {...storyblokEditable(navItem as SbBlokData)}><a href={navItem.url}>{navItem.label}</a></li>
        })
      }
    </ul>

    {/* Submenu - Afficher seulement si il y a des items */}
    {blok.submenu_items && blok.submenu_items.length > 0 && (
      <select>
        {
          blok.submenu_items.map((item) => {
            return <option>{item}</option>;
          })
        }
      </select>
    )}

    <Image {...storyblokEditable(blok as SbBlokData)}
      src={blok.profile_avatar?.filename || ""}
      alt={blok.profile_avatar?.alt || "Profil utilisateur"}
      width={40}
      height={40}
      loading="lazy"
    />
  </div>
</nav>
